// ===================================
// Language Translations
// ===================================

const translations = {
    en: {
        // Navigation
        nav_home: "Home",
        nav_about: "About",
        nav_properties: "Properties",
        nav_services: "Services",
        nav_contact: "Contact",

        // Hero Section
        hero_luxury: "Luxury",
        hero_title: "Find Your Dream Property in Ajman",
        hero_description: "Discover exceptional properties in the heart of the UAE with Alamaaria Real Estate",
        hero_cta: "Explore Properties",
        hero_cta_contact: "Get in Touch",

        // About Section
        about_title: "About Alamaaria",
        about_subtitle: "Your Trusted Partner in Real Estate",
        about_p1: "Alamaaria Real Estate is your premier destination for luxury properties in Ajman, UAE. With years of experience in the real estate market, we specialize in connecting clients with their dream homes and investment opportunities.",
        about_p2: "Our commitment to excellence, personalized service, and deep understanding of the local market sets us apart. Whether you're buying, selling, or renting, we're here to guide you every step of the way.",

        // Properties Section
        properties_title: "Featured Properties",
        properties_subtitle: "Discover Our Exclusive Listings",
        beds: "Beds",
        baths: "Baths",
        view_details: "View Details",
        aed: "AED",

        // Services Section
        services_title: "Our Services",
        services_subtitle: "Comprehensive Real Estate Solutions",
        service_sales_title: "Property Sales",
        service_sales_desc: "Expert guidance in buying and selling luxury properties with comprehensive market analysis.",
        service_rental_title: "Property Rental",
        service_rental_desc: "Find your perfect rental property with our comprehensive listing of luxury homes and apartments.",
        service_consulting_title: "Investment Consulting",
        service_consulting_desc: "Strategic real estate investment advice to maximize your returns in the UAE market.",

        // Contact Section
        contact_title: "Get In Touch",
        contact_subtitle: "We're Here to Help",
        contact_phone: "Phone",
        contact_email: "Email",
        contact_address: "Address",
        contact_address_text: "Ajman, UAE",

        // Contact Form
        form_name: "Your Name",
        form_email: "Email Address",
        form_phone: "Phone Number",
        form_interest: "I'm interested in",
        form_interest_buying: "Buying a Property",
        form_interest_selling: "Selling a Property",
        form_interest_renting: "Renting a Property",
        form_interest_consulting: "Investment Consulting",
        form_message: "Message",
        form_submit: "Send Message",
        form_success: "Thank you for your inquiry! We will get back to you soon.",

        // Footer
        footer_brand_desc: "Your trusted partner in luxury real estate",
        footer_quick_links: "Quick Links",
        footer_follow: "Follow Us",
        footer_rights: "© 2025 Alamaaria Real Estate. All rights reserved.",

        // Property Detail Page
        property_featured: "Featured Property",
        property_back: "← Back to Properties",
        property_share: "Share this property:",
        property_description_title: "Property Description",
        property_contact_title: "Interested in this property?",
        property_contact_subtitle: "Fill out the form below and we'll get back to you shortly.",
        property_not_found: "Property Not Found",
        property_not_found_desc: "This property may have been removed or doesn't exist.",
        property_view_all: "View All Properties",
        loading: "Loading property details...",

        // Share Buttons
        share_whatsapp: "WhatsApp",
        share_facebook: "Facebook",
        share_x: "X",
        share_linkedin: "LinkedIn",
        share_email: "Email",
        share_copy: "Copy Link",
        share_copied: "Link copied to clipboard!",
        share_failed: "Failed to copy link",
        share_text: "Check out this amazing property:",

        // Admin Panel
        admin_login: "Admin Login",
        admin_username: "Username",
        admin_password: "Password",
        admin_login_btn: "Login",
        admin_logout: "Logout",
        admin_panel_title: "Property Management",
        admin_add_property: "Add New Property",
        admin_edit: "Edit",
        admin_delete: "Delete",
        admin_no_properties: "No Properties Yet",
        admin_get_started: "Click 'Add New Property' to get started",

        // Property Form
        form_add_title: "Add New Property",
        form_edit_title: "Edit Property",
        form_property_title: "Property Title",
        form_location: "Location",
        form_beds: "Bedrooms",
        form_baths: "Bathrooms",
        form_area: "Area (m²)",
        form_price: "Price (AED)",
        form_featured: "Featured Property",
        form_yes: "Yes",
        form_no: "No",
        form_images: "Property Images",
        form_upload_hint: "Click to upload images or drag and drop",
        form_file_hint: "PNG, JPG, WEBP up to 5MB each",
        form_primary: "Primary",
        form_description: "Description",
        form_save: "Save Property",
        form_cancel: "Cancel",

        // Notifications
        notification_added: "Property added successfully!",
        notification_updated: "Property updated successfully!",
        notification_deleted: "Property deleted successfully!",
        notification_inquiry_sent: "Thank you for your inquiry! We will contact you soon.",

        // Delete Confirmation
        delete_confirm_title: "Confirm Deletion",
        delete_confirm_message: "Are you sure you want to delete this property? This action cannot be undone.",
        delete_confirm_btn: "Delete Property",
        delete_cancel: "Cancel"
    },

    ar: {
        // Navigation
        nav_home: "الرئيسية",
        nav_about: "من نحن",
        nav_properties: "العقارات",
        nav_services: "خدماتنا",
        nav_contact: "اتصل بنا",

        // Hero Section
        hero_luxury: "الفخامة",
        hero_title: "اعثر على عقار أحلامك في عجمان",
        hero_description: "اكتشف عقارات استثنائية في قلب الإمارات مع العماريا للعقارات",
        hero_cta: "استكشف العقارات",
        hero_cta_contact: "تواصل معنا",

        // About Section
        about_title: "عن العماريا",
        about_subtitle: "شريكك الموثوق في العقارات",
        about_p1: "العماريا للعقارات هي وجهتك الأولى للعقارات الفاخرة في عجمان، الإمارات. مع سنوات من الخبرة في سوق العقارات، نتخصص في ربط العملاء بمنازل أحلامهم وفرص الاستثمار.",
        about_p2: "التزامنا بالتميز والخدمة الشخصية والفهم العميق للسوق المحلي يميزنا. سواء كنت تشتري أو تبيع أو تستأجر، نحن هنا لإرشادك في كل خطوة.",

        // Properties Section
        properties_title: "العقارات المميزة",
        properties_subtitle: "اكتشف قائمتنا الحصرية",
        beds: "غرف نوم",
        baths: "حمامات",
        view_details: "عرض التفاصيل",
        aed: "درهم",

        // Services Section
        services_title: "خدماتنا",
        services_subtitle: "حلول عقارية شاملة",
        service_sales_title: "بيع العقارات",
        service_sales_desc: "إرشادات متخصصة في شراء وبيع العقارات الفاخرة مع تحليل شامل للسوق.",
        service_rental_title: "تأجير العقارات",
        service_rental_desc: "اعثر على عقار الإيجار المثالي مع قائمتنا الشاملة من المنازل والشقق الفاخرة.",
        service_consulting_title: "الاستشارات الاستثمارية",
        service_consulting_desc: "نصائح استثمارية استراتيجية في العقارات لتعظيم عوائدك في سوق الإمارات.",

        // Contact Section
        contact_title: "تواصل معنا",
        contact_subtitle: "نحن هنا للمساعدة",
        contact_phone: "الهاتف",
        contact_email: "البريد الإلكتروني",
        contact_address: "العنوان",
        contact_address_text: "عجمان، الإمارات",

        // Contact Form
        form_name: "اسمك",
        form_email: "البريد الإلكتروني",
        form_phone: "رقم الهاتف",
        form_interest: "أنا مهتم بـ",
        form_interest_buying: "شراء عقار",
        form_interest_selling: "بيع عقار",
        form_interest_renting: "استئجار عقار",
        form_interest_consulting: "الاستشارات الاستثمارية",
        form_message: "رسالتك",
        form_submit: "إرسال الرسالة",
        form_success: "شكراً لاستفسارك! سنتواصل معك قريباً.",

        // Footer
        footer_brand_desc: "شريكك الموثوق في العقارات الفاخرة",
        footer_quick_links: "روابط سريعة",
        footer_follow: "تابعنا",
        footer_rights: "© 2025 العماريا للعقارات. جميع الحقوق محفوظة.",

        // Property Detail Page
        property_featured: "عقار مميز",
        property_back: "← العودة إلى العقارات",
        property_share: "شارك هذا العقار:",
        property_description_title: "وصف العقار",
        property_contact_title: "مهتم بهذا العقار؟",
        property_contact_subtitle: "املأ النموذج أدناه وسنتواصل معك قريباً.",
        property_not_found: "العقار غير موجود",
        property_not_found_desc: "ربما تمت إزالة هذا العقار أو غير موجود.",
        property_view_all: "عرض جميع العقارات",
        loading: "جاري تحميل تفاصيل العقار...",

        // Share Buttons
        share_whatsapp: "واتساب",
        share_facebook: "فيسبوك",
        share_x: "إكس",
        share_linkedin: "لينكد إن",
        share_email: "البريد الإلكتروني",
        share_copy: "نسخ الرابط",
        share_copied: "تم نسخ الرابط!",
        share_failed: "فشل نسخ الرابط",
        share_text: "اطلع على هذا العقار المذهل:",

        // Admin Panel
        admin_login: "تسجيل دخول المشرف",
        admin_username: "اسم المستخدم",
        admin_password: "كلمة المرور",
        admin_login_btn: "تسجيل الدخول",
        admin_logout: "تسجيل الخروج",
        admin_panel_title: "إدارة العقارات",
        admin_add_property: "إضافة عقار جديد",
        admin_edit: "تعديل",
        admin_delete: "حذف",
        admin_no_properties: "لا توجد عقارات بعد",
        admin_get_started: "انقر على 'إضافة عقار جديد' للبدء",

        // Property Form
        form_add_title: "إضافة عقار جديد",
        form_edit_title: "تعديل العقار",
        form_property_title: "عنوان العقار",
        form_location: "الموقع",
        form_beds: "غرف النوم",
        form_baths: "الحمامات",
        form_area: "المساحة (م²)",
        form_price: "السعر (درهم)",
        form_featured: "عقار مميز",
        form_yes: "نعم",
        form_no: "لا",
        form_images: "صور العقار",
        form_upload_hint: "انقر لتحميل الصور أو اسحب وأفلت",
        form_file_hint: "PNG، JPG، WEBP حتى 5 ميجابايت لكل صورة",
        form_primary: "رئيسية",
        form_description: "الوصف",
        form_save: "حفظ العقار",
        form_cancel: "إلغاء",

        // Notifications
        notification_added: "تمت إضافة العقار بنجاح!",
        notification_updated: "تم تحديث العقار بنجاح!",
        notification_deleted: "تم حذف العقار بنجاح!",
        notification_inquiry_sent: "شكراً لاستفسارك! سنتواصل معك قريباً.",

        // Delete Confirmation
        delete_confirm_title: "تأكيد الحذف",
        delete_confirm_message: "هل أنت متأكد من حذف هذا العقار؟ لا يمكن التراجع عن هذا الإجراء.",
        delete_confirm_btn: "حذف العقار",
        delete_cancel: "إلغاء"
    }
};

// ===================================
// Language Management
// ===================================

class LanguageManager {
    constructor() {
        this.currentLang = this.getSavedLanguage() || 'en';

        // Apply language direction immediately to prevent flash
        document.documentElement.setAttribute('dir', this.currentLang === 'ar' ? 'rtl' : 'ltr');
        document.documentElement.setAttribute('lang', this.currentLang);

        // Wait for DOM to be ready before applying full language
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                this.applyLanguage();
            });
        } else {
            this.applyLanguage();
        }
    }

    getSavedLanguage() {
        return localStorage.getItem('alamaaria_language');
    }

    saveLanguage(lang) {
        localStorage.setItem('alamaaria_language', lang);
    }

    setLanguage(lang) {
        console.log('setLanguage called with:', lang);
        console.log('Current language:', this.currentLang);
        console.log('Translation exists:', !!translations[lang]);

        if (translations[lang]) {
            this.currentLang = lang;
            this.saveLanguage(lang);
            this.applyLanguage();
            console.log('Language changed to:', lang);
        } else {
            console.error('No translation found for language:', lang);
        }
    }

    applyLanguage() {
        console.log('applyLanguage called for:', this.currentLang);

        // Set HTML direction
        document.documentElement.setAttribute('dir', this.currentLang === 'ar' ? 'rtl' : 'ltr');
        document.documentElement.setAttribute('lang', this.currentLang);
        console.log('Direction set to:', document.documentElement.getAttribute('dir'));

        // Update all elements with data-i18n attribute
        const i18nElements = document.querySelectorAll('[data-i18n]');
        console.log('Found elements with data-i18n:', i18nElements.length);

        i18nElements.forEach(element => {
            const key = element.getAttribute('data-i18n');
            if (translations[this.currentLang][key]) {
                element.textContent = translations[this.currentLang][key];
            }
        });

        // Update all elements with data-i18n-placeholder attribute
        document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
            const key = element.getAttribute('data-i18n-placeholder');
            if (translations[this.currentLang][key]) {
                element.placeholder = translations[this.currentLang][key];
            }
        });

        // Update language switcher buttons
        this.updateLanguageSwitcher();

        // Trigger custom event for language change
        document.dispatchEvent(new CustomEvent('languageChanged', {
            detail: { language: this.currentLang }
        }));
        console.log('Language change event dispatched');
    }

    updateLanguageSwitcher() {
        const langButtons = document.querySelectorAll('.lang-btn');
        langButtons.forEach(btn => {
            if (btn.dataset.lang === this.currentLang) {
                btn.classList.add('active');
            } else {
                btn.classList.remove('active');
            }
        });
    }

    translate(key) {
        return translations[this.currentLang][key] || key;
    }

    getCurrentLanguage() {
        return this.currentLang;
    }

    isRTL() {
        return this.currentLang === 'ar';
    }
}

// Initialize language manager and expose globally
window.languageManager = new LanguageManager();

// Also create a const reference for backwards compatibility
const languageManager = window.languageManager;

// Debug: Log to verify languageManager is initialized
console.log('LanguageManager initialized:', window.languageManager);
console.log('Current language:', window.languageManager.currentLang);

// Export for use in other scripts (Node.js environments)
if (typeof module !== 'undefined' && module.exports) {
    module.exports = { languageManager, translations };
}
